{"version":3,"sources":["app.js"],"names":["express","require","morgan","rateLimit","helmet","mongoSanitize","xss","AppError","globalErrorHandler","titleRouter","userRouter","hallRouter","reviewRouter","app","use","process","env","NODE_ENV","limiter","max","windowMs","message","json","limit","__dirname","req","res","next","requestTime","Date","toISOString","all","originalUrl","module","exports"],"mappings":";;AAAA,IAAMA,OAAO,GAAGC,OAAO,CAAC,SAAD,CAAvB;;AACA,IAAMC,MAAM,GAAGD,OAAO,CAAC,QAAD,CAAtB;;AACA,IAAME,SAAS,GAAGF,OAAO,CAAC,oBAAD,CAAzB;;AACA,IAAMG,MAAM,GAAGH,OAAO,CAAC,QAAD,CAAtB;;AACA,IAAMI,aAAa,GAAGJ,OAAO,CAAC,wBAAD,CAA7B;;AACA,IAAMK,GAAG,GAAGL,OAAO,CAAC,WAAD,CAAnB,C,CACA;;;AAEA,IAAMM,QAAQ,GAAGN,OAAO,CAAC,kBAAD,CAAxB;;AACA,IAAMO,kBAAkB,GAAGP,OAAO,CAAC,+BAAD,CAAlC;;AACA,IAAMQ,WAAW,GAAGR,OAAO,CAAC,sBAAD,CAA3B;;AACA,IAAMS,UAAU,GAAGT,OAAO,CAAC,qBAAD,CAA1B;;AACA,IAAMU,UAAU,GAAGV,OAAO,CAAC,qBAAD,CAA1B;;AACA,IAAMW,YAAY,GAAGX,OAAO,CAAC,uBAAD,CAA5B;;AAEA,IAAMY,GAAG,GAAGb,OAAO,EAAnB,C,CAEA;AACA;;AACAa,GAAG,CAACC,GAAJ,CAAQV,MAAM,EAAd,E,CAEA;;AACA,IAAIW,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,aAA7B,EAA4C;AAC1CJ,EAAAA,GAAG,CAACC,GAAJ,CAAQZ,MAAM,CAAC,KAAD,CAAd;AACD,C,CAED;;;AACA,IAAMgB,OAAO,GAAGf,SAAS,CAAC;AACxBgB,EAAAA,GAAG,EAAE,GADmB;AAExBC,EAAAA,QAAQ,EAAE,KAAK,EAAL,GAAU,IAFI;AAGxBC,EAAAA,OAAO,EAAE;AAHe,CAAD,CAAzB;AAKAR,GAAG,CAACC,GAAJ,CAAQ,MAAR,EAAgBI,OAAhB,E,CAEA;;AACAL,GAAG,CAACC,GAAJ,CAAQd,OAAO,CAACsB,IAAR,CAAa;AAAEC,EAAAA,KAAK,EAAE;AAAT,CAAb,CAAR,E,CAEA;;AACAV,GAAG,CAACC,GAAJ,CAAQT,aAAa,EAArB,E,CAEA;;AACAQ,GAAG,CAACC,GAAJ,CAAQR,GAAG,EAAX,E,CAEA;AAEA;;AACAO,GAAG,CAACC,GAAJ,CAAQd,OAAO,UAAP,WAAkBwB,SAAlB,aAAR,E,CAEA;;AACAX,GAAG,CAACC,GAAJ,CAAQ,UAACW,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC1BF,EAAAA,GAAG,CAACG,WAAJ,GAAkB,IAAIC,IAAJ,GAAWC,WAAX,EAAlB,CAD0B,CAE1B;;AACAH,EAAAA,IAAI;AACL,CAJD,E,CAMA;;AACAd,GAAG,CAACC,GAAJ,CAAQ,gBAAR,EAA0BL,WAA1B;AACAI,GAAG,CAACC,GAAJ,CAAQ,eAAR,EAAyBH,UAAzB;AACAE,GAAG,CAACC,GAAJ,CAAQ,eAAR,EAAyBJ,UAAzB;AACAG,GAAG,CAACC,GAAJ,CAAQ,iBAAR,EAA2BF,YAA3B;AAEAC,GAAG,CAACkB,GAAJ,CAAQ,GAAR,EAAa,UAACN,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC/BA,EAAAA,IAAI,CAAC,IAAIpB,QAAJ,sBAA2BkB,GAAG,CAACO,WAA/B,uBAA8D,GAA9D,CAAD,CAAJ;AACD,CAFD;AAIAnB,GAAG,CAACC,GAAJ,CAAQN,kBAAR;AAEAyB,MAAM,CAACC,OAAP,GAAiBrB,GAAjB","sourcesContent":["const express = require('express');\nconst morgan = require('morgan');\nconst rateLimit = require('express-rate-limit');\nconst helmet = require('helmet');\nconst mongoSanitize = require('express-mongo-sanitize');\nconst xss = require('xss-clean');\n// const hpp = require('hpp');\n\nconst AppError = require('./utils/appError');\nconst globalErrorHandler = require('./controllers/errorController');\nconst titleRouter = require('./routes/titleRoutes');\nconst userRouter = require('./routes/userRoutes');\nconst hallRouter = require('./routes/hallRoutes');\nconst reviewRouter = require('./routes/reviewRoutes');\n\nconst app = express();\n\n// 1) GLOBAL MIDDLEWARE\n// Set security HTTP headers\napp.use(helmet());\n\n// Development logging\nif (process.env.NODE_ENV === 'development') {\n  app.use(morgan('dev'));\n}\n\n// Limit requests from same API\nconst limiter = rateLimit({\n  max: 100,\n  windowMs: 60 * 60 * 1000,\n  message: 'Too many requests from this IP, please try again in an hour!'\n});\napp.use('/api', limiter);\n\n// Body parser, reading data from body into req.body\napp.use(express.json({ limit: '10kb' }));\n\n// Data sanitization against NoSQL query injection\napp.use(mongoSanitize());\n\n// Data sanitization against XSS\napp.use(xss());\n\n// Prevent parameter pollution\n\n// Serving static files\napp.use(express.static(`${__dirname}/public`));\n\n// Test middleware\napp.use((req, res, next) => {\n  req.requestTime = new Date().toISOString();\n  // console.log(req.headers);\n  next();\n});\n\n// 3) ROUTES\napp.use('/api/v1/titles', titleRouter);\napp.use('/api/v1/halls', hallRouter);\napp.use('/api/v1/users', userRouter);\napp.use('/api/v1/reviews', reviewRouter);\n\napp.all('*', (req, res, next) => {\n  next(new AppError(`Can't find ${req.originalUrl} on this server!`, 404));\n});\n\napp.use(globalErrorHandler);\n\nmodule.exports = app;\n"],"file":"app.dev.js"}